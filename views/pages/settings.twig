{% extends 'layout.twig' %}

{% block content %}
    <div class="starter-template">
        <h1>{{ 'settings'|trans }}</h1>
    </div>
    <div class="row">
        <div class="col-md-3"></div>
        <div class="col-md-6">
            <div class="panel panel-default ">
                <div class="panel-body">
                    {{ form_start(form) }}
                    <div class="col-lg-12">
                        <h2>{{'fix.errors'|trans}}</h2>
                        <p>
                            {{ 'fix.errors.description'|trans }}
                        </p>
                    </div>
                    <div class="col-lg-12">
                        <p>
                            {{ form_widget(form.batch) }}
                        </p>
                    </div>
                    <div class="col-lg-12">
                        <p>
                            {{ form_widget(form.send) }}
                        </p>
                    </div>
                    <div class="col-lg-12">
                        <p>
                        {% if success is defined  and success == true %}
                            <div class="alert alert-dismissible alert-success">
                                <strong>{{'success'|trans}}</strong> {{'success.description'|trans}}.
                            </div>
                        {%endif%}
                        </p>
                    </div>
                    {{ form_end(form) }}

                    <h4>{{'batch.list'|trans}}</h4>
                    <table class="table table-striped table-hover " id="table_batchs">
                        <thead>
                            <tr>
                                <th>{{'date'|trans}}</th>
                                <th>{{'action'|trans}}</th>
                                <th>{{'state'|trans}}</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-md-3"></div>
    </div>
    <div class="row">
        <div class="col-md-3"></div>
        <div class="col-md-6">
            <div class="panel panel-default ">
                <div class="panel-body">
                    <div class="col-lg-12">
                        <h2>{{'technical.informations'|trans}}</h2>
                        <p>{{'mirakl.connector.version'|trans}} {{version['integration']}}</p>
                        <p>{{'mirakl.library.version'|trans}} {{version['library']}}</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3"></div>
    </div>
    <div class="row">
        <div class="col-md-3"></div>
        <div class="col-md-6">
            <div class="panel panel-default ">
                <div class="panel-body">
                    <div class="col-lg-12">
                        <h2>{{'app.update'|trans}}</h2>
                        {% if isWritable %}
                            {% if updateLibrary or updateIntegration %}
                                <div class="alert alert-warning">
                                    <h4>{{'update.available'|trans}}</h4>
                                    {% if  updateIntegration %}
                                        <p>{{'update.app.latest'|trans}}</p>
                                    {%else%}    
                                        <p>{{'update.library.patch'|trans}}</p>
                                    {%endif%}
                                </div>    
                                    {% if  updateIntegration  %}
                                        {%if dbms != 'pdo_mysql' %}
                                             <div class="alert alert-danger">
                                                 <p>{{'dbms.not.mysql'|trans}}</p>
                                             </div>
                                        {%endif%}
                                        <div class="col-md-12 text-center"> 
                                            <form method="POST" action="{{path('update-integration')}}">
                                                <input type="submit" class="btn btn-info" value="{{'update.all.app'|trans}}" />
                                            </form>
                                        </div>
                                    {%else%}
                                        <div class="col-md-12 text-center"> 
                                            <form method="POST" action="{{path('update-library')}}">
                                                <input type="submit" class="btn btn-info" value="{{'update.library'|trans}}" />
                                            </form>
                                        </div>
                                    {%endif%}
                                    <p></p>
                                
                           {%else%}
                               <div class="alert alert-success">
                                    <h4>{{'everything.up.to.date'|trans}}</h4>
                                </div>
                           {%endif%}
                        {%else%}
                            <div class="alert alert-danger">
                                <p>{{'sufficient.right'|trans}}</p>
                                <p>{{'commands.execute'|trans}} : </p>
                                <blockquote>
                                    <small> chown -R < web_server_user >:< group_of_web_server_user > < path_to_your_dir > </small>
                                    <small> chmod 755 -R < path_to_your_dir > </small>
                                </<blockquote>
                                <p></p>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3"></div>
    </div>
{% endblock %}